
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€ì œì—­ í’ê²½ì±„ 2BL ì”ê¸ˆ ê³„ì‚°ê¸°</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; background: #e8f5e9; color: #333; padding: 15px; }
        .container { max-width: 500px; margin: 0 auto; background: #fff; padding: 20px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); border-left: 10px solid #4caf50; }
        header { text-align: center; margin-bottom: 20px; background: #f1f8e9; padding: 20px; border-radius: 10px; border: 2px dashed #4caf50; }
        h1 { font-size: 1.25em; color: #2e7d32; margin: 0; font-weight: 900; }
        h2 { font-size: 1.1em; color: #388e3c; margin: 10px 0 5px 0; font-weight: 800; }
        .sub-title { font-size: 0.9em; color: #1b5e20; font-weight: 900; background: #c8e6c9; padding: 3px 12px; border-radius: 20px; }
        .card { border: 1px solid #ddd; padding: 15px; border-radius: 10px; margin-bottom: 12px; background: #fafafa; }
        .bg-navy { background: #1a2a40; color: white; border: none; }
        label { font-size: 0.85em; font-weight: bold; margin-bottom: 5px; display: block; }
        input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 1.1em; font-weight: bold; background: #fff; }
        .kor-txt { font-size: 0.85em; color: #007bff; margin-top: 5px; font-weight: bold; }
        .row-detail { display: flex; justify-content: space-between; font-size: 0.85em; margin-top: 10px; color: #555; background: #f0f4f0; padding: 8px; border-radius: 5px; }
        .btn-add { width: 100%; padding: 12px; background: #fff; border: 2px dashed #4caf50; color: #2e7d32; border-radius: 8px; cursor: pointer; margin: 10px 0; font-weight: bold; }
        .final-area { background: #fffde7; border: 2px solid #fbc02d; padding: 15px; border-radius: 10px; margin-top: 20px; }
        .final-val { font-size: 1.5em; color: #d32f2f; font-weight: 900; display: block; margin: 8px 0; }
        .zero-msg { color: #d32f2f; font-weight: bold; font-size: 0.85em; margin-top: 10px; padding: 12px; background: #ffebee; border-radius: 8px; border: 1px solid #ef9a9a; line-height: 1.5; }
        .total-summary { background: #ffebee; padding: 15px; border-radius: 10px; margin-top: 15px; font-weight: bold; text-align: right; border: 2px solid #ef9a9a; color: #c62828; }
        .footer-red { background: #fff5f5; border-radius: 10px; padding: 15px; margin-top: 10px; border: 1px solid #ffa8a8; color: #e03131; font-size: 0.8em; line-height: 1.6; text-align: center; }
        .warning-msg { font-size: 0.75em; font-weight: bold; margin-top: 5px; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ“ ì§€ì œì—­ í’ê²½ì±„ì–´ë°”ë‹ˆí‹° 2BL</h1>
        <h2>ì”ê¸ˆì„ ë‚©í• ì¸ 7% ëª¨ì˜ê³„ì‚°ê¸°</h2>
        <div class="sub-title">3/24 ì™„ë‚© ì¡°ê±´ë¶€ ê³„ì‚°ê¸°</div>
    </header>

    <div class="card bg-navy">
        <label style="color:#a5d6a7;">ë‚˜ì˜ ì´ˆê¸° ì´ ì”ê¸ˆ</label>
        <input type="text" id="base-total" oninput="updateBase(this)" placeholder="ì´ ì”ê¸ˆì„ ì…ë ¥í•˜ì„¸ìš”">
        <div id="base-total-kor" class="kor-txt" style="color:#81d4fa;">ì˜ ì›</div>
    </div>

    <div id="row-area"></div>
    <button class="btn-add" onclick="addRow()">+ ì¤‘ê°„ ë‚©ë¶€ ë‚´ì—­ ì¶”ê°€</button>

    <div class="final-area">
        <label>ğŸ—“ï¸ ë§ˆì§€ë§‰ ì”ê¸ˆ ì™„ë‚© ì˜ˆì •ì¼</label>
        <input type="date" id="final-date" oninput="calculate()">
        <div style="margin-top:15px; font-size:0.9em; border-top:1px dashed #fbc02d; padding-top:10px;">
            ì¤‘ê°„ ì›ê¸ˆ ë‚©ë¶€ í›„ ì”ì•¡: <b id="f-rem-bal">0ì›</b><br>
            ì™„ë‚©ì¼ ê¸°ì¤€ í˜œíƒ ì¼ìˆ˜: <b id="f-days">0ì¼</b><br>
            ë§ˆì§€ë§‰ í˜œíƒ ì´ì: <b id="f-int" style="color:#d32f2f;">0ì›</b>
            <span class="final-val" id="f-pay">ìµœì¢… ì‹¤ ì…ê¸ˆì•¡: 0ì›</span>
            <div id="f-pay-kor" class="kor-txt">ì˜ ì›</div>
            <div id="zero-notice" class="zero-msg" style="display:none;"></div>
        </div>
    </div>

    <div class="total-summary">
        ì ìš©ëœ ì´ í˜œíƒ í•©ê³„: <span id="total-interest" style="font-size:1.3em;">0</span>ì›
    </div>

    <div class="footer-red">
        <strong>âš ï¸ ì¤‘ìš”: 3/24 ì™„ë‚© ì¡°ê±´</strong><br>
        ì™„ë‚©ì¼ì´ <b>2026ë…„ 3ì›” 24ì¼</b>ì„ ì´ˆê³¼í•  ê²½ìš°, ê¸°ì¡´ì˜ ëª¨ë“  ì„ ë‚©í• ì¸ í˜œíƒì€ ì‹¤íš¨(0ì›)ë˜ì–´ ì”ì•¡ì— ë‹¤ì‹œ í•©ì‚°ë©ë‹ˆë‹¤.
    </div>
</div>

<script>
    const RATE = 0.07;
    const END_D = new Date('2026-05-04');
    const LIMIT_D = new Date('2026-03-24');

    function updateBase(el) {
        let val = el.value.replace(/[^0-9]/g, '');
        el.value = val ? Number(val).toLocaleString() : '';
        document.getElementById('base-total-kor').innerText = val ? numberToKorean(val) + " ì›" : "ì˜ ì›";
        calculate();
    }

    function numberToKorean(number) {
        const units = ['', 'ë§Œ', 'ì–µ', 'ì¡°'];
        let result = '';
        let num = parseInt(number);
        if (num === 0 || isNaN(num)) return 'ì˜';
        for (let i = 0; num > 0; i++) {
            let chunk = num % 10000;
            if (chunk > 0) result = chunk.toLocaleString() + units[i] + ' ' + result;
            num = Math.floor(num / 10000);
        }
        return result.trim();
    }

    function addRow() {
        const id = 'row-' + Date.now();
        const div = document.createElement('div');
        div.className = 'card';
        div.id = id;
        div.innerHTML = `
            <div style="display:flex; gap:10px; margin-bottom:5px;">
                <input type="date" class="i-date" oninput="calculate()" style="flex:1; font-size:0.9em;">
                <input type="text" class="i-amt" placeholder="ì…ê¸ˆì•¡" oninput="handleRowInput(this, '${id}')" style="flex:1.2; font-size:0.9em;">
            </div>
            <div id="${id}-kor" class="kor-txt" style="font-size:0.75em;">ì˜ ì›</div>
            <div class="warning-msg" id="${id}-warn"></div>
            <div class="row-detail">
                <span>ê³„ì‚°ì´ì: <b class="r-int">0ì›</b></span>
                <span><b>ì°¨ê° ì”ì•¡:</b> <b class="r-bal">0ì›</b></span>
            </div>
            <div onclick="document.getElementById('${id}').remove();calculate();" style="text-align:right; color:#ccc; cursor:pointer; font-size:0.75em; margin-top:5px;">ì‚­ì œ</div>
        `;
        document.getElementById('row-area').appendChild(div);
    }

    function handleRowInput(el, rowId) {
        let val = el.value.replace(/[^0-9]/g, '');
        el.value = val ? Number(val).toLocaleString() : '';
        document.getElementById(rowId + '-kor').innerText = val ? numberToKorean(val) : "ì˜ ì›";
        calculate();
    }

    function calculate() {
        const fDateInput = document.getElementById('final-date');
        const fDate = fDateInput.value ? new Date(fDateInput.value) : null;
        const isExpired = fDate && fDate > LIMIT_D; // 3/24 ì´ˆê³¼ ì—¬ë¶€

        let baseTotal = parseInt(document.getElementById('base-total').value.replace(/,/g, '')) || 0;
        let currentBal = baseTotal;
        let totalIntSum = 0;
        const rows = document.querySelectorAll('#row-area .card');

        // ì¤‘ê°„ ë‚©ë¶€ ê³„ì‚°
        rows.forEach(row => {
            const dateInput = row.querySelector('.i-date');
            const amtInput = row.querySelector('.i-amt');
            const warn = row.querySelector('.warning-msg');
            let aVal = parseInt(amtInput.value.replace(/,/g, '')) || 0;

            let interest = 0;
            if (dateInput.value) {
                const payDate = new Date(dateInput.value);
                let days = Math.floor((END_D - payDate) / (1000 * 60 * 60 * 24)) + 1;
                days = Math.max(0, Math.min(100, days));

                // ì™„ë‚©ì¼ì´ ì§€ë‚¬ê±°ë‚˜ ì…ê¸ˆì•¡ 1ì²œë§Œ ì› ë¯¸ë§Œì´ë©´ ì´ì 0
                if (isExpired) {
                    interest = 0;
                    warn.innerText = "âš ï¸ ì™„ë‚© ê¸°í•œ ë„ê³¼ë¡œ í˜œíƒ ì†Œë©¸";
                    warn.style.color = "#d32f2f";
                } else if (aVal < 10000000) {
                    interest = 0;
                    warn.innerText = "âš ï¸ 1,000ë§Œ ì› ë¯¸ë§Œ í˜œíƒ ì œì™¸";
                    warn.style.color = "#d32f2f";
                } else {
                    interest = Math.floor((aVal * RATE * days / 365) / 10) * 10;
                    warn.innerText = "âœ… ì„ ë‚© í˜œíƒ ì ìš© ì¤‘ (" + days + "ì¼)";
                    warn.style.color = "#2e7d32";
                }
            }
            
            currentBal = currentBal - aVal - interest;
            totalIntSum += interest;
            row.querySelector('.r-int').innerText = interest.toLocaleString() + "ì›";
            row.querySelector('.r-bal').innerText = Math.max(0, currentBal).toLocaleString() + "ì›";
        });

        // ë§ˆì§€ë§‰ ì™„ë‚© ê³„ì‚°
        const zeroNotice = document.getElementById('zero-notice');
        document.getElementById('f-rem-bal').innerText = Math.max(0, currentBal).toLocaleString() + "ì›";

        if (fDate && currentBal > 0) {
            let finalInt = 0;
            let fDays = 0;

            if (isExpired) {
                zeroNotice.innerHTML = "ğŸš¨ 3ì›” 24ì¼ì´ ê²½ê³¼ë˜ì–´ ëª¨ë“  ì„ ë‚©í• ì¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤. ì›ê¸ˆ ì „ì•¡ì„ ë‚©ë¶€í•´ì•¼ í•©ë‹ˆë‹¤.";
                zeroNotice.style.display = 'block';
                fDays = 0;
                finalInt = 0;
            } else {
                fDays = Math.floor((END_D - fDate) / (1000 * 60 * 60 * 24)) + 1;
                fDays = Math.max(0, Math.min(100, fDays));
                finalInt = Math.floor((currentBal * RATE * fDays / 365) / 10) * 10;
                zeroNotice.style.display = 'none';
            }

            let finalPay = currentBal - finalInt;
            document.getElementById('f-days').innerText = fDays + "ì¼";
            document.getElementById('f-int').innerText = finalInt.toLocaleString() + "ì›";
            document.getElementById('f-pay').innerText = "ìµœì¢… ì‹¤ ì…ê¸ˆì•¡: " + Math.max(0, finalPay).toLocaleString() + "ì›";
            document.getElementById('f-pay-kor').innerText = numberToKorean(Math.max(0, finalPay)) + " ì›";
            totalIntSum += finalInt;
        } else {
            document.getElementById('f-days').innerText = "0ì¼";
            document.getElementById('f-int').innerText = "0ì›";
            document.getElementById('f-pay').innerText = "ìµœì¢… ì‹¤ ì…ê¸ˆì•¡: 0ì›";
            zeroNotice.style.display = 'none';
        }
        document.getElementById('total-interest').innerText = totalIntSum.toLocaleString();
    }
    window.onload = () => addRow();
</script>
</body>
</html>
