
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€ì œì—­ í’ê²½ì±„ 2BL ì”ê¸ˆ ê³„ì‚°ê¸°</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; background: #e8f5e9; color: #333; padding: 15px; }
        .container { max-width: 500px; margin: 0 auto; background: #fff; padding: 20px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); border-left: 10px solid #4caf50; }
        header { text-align: center; margin-bottom: 20px; background: #f1f8e9; padding: 20px; border-radius: 10px; border: 2px dashed #4caf50; }
        h1 { font-size: 1.25em; color: #2e7d32; margin: 0; font-weight: 900; }
        h2 { font-size: 1.1em; color: #388e3c; margin: 10px 0 5px 0; font-weight: 800; }
        .sub-title { font-size: 0.9em; color: #1b5e20; font-weight: 900; background: #c8e6c9; padding: 3px 12px; border-radius: 20px; }
        .card { border: 1px solid #ddd; padding: 15px; border-radius: 10px; margin-bottom: 12px; background: #fafafa; }
        .bg-navy { background: #1a2a40; color: white; border: none; }
        label { font-size: 0.85em; font-weight: bold; margin-bottom: 5px; display: block; }
        input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 1.1em; font-weight: bold; background: #fff; }
        .kor-txt { font-size: 0.85em; color: #007bff; margin-top: 5px; font-weight: bold; }
        .row-detail { display: flex; justify-content: space-between; font-size: 0.85em; margin-top: 10px; color: #555; background: #f0f4f0; padding: 8px; border-radius: 5px; }
        .btn-add { width: 100%; padding: 12px; background: #fff; border: 2px dashed #4caf50; color: #2e7d32; border-radius: 8px; cursor: pointer; margin: 10px 0; font-weight: bold; }
        .final-area { background: #fffde7; border: 2px solid #fbc02d; padding: 15px; border-radius: 10px; margin-top: 20px; }
        .final-val { font-size: 1.5em; color: #d32f2f; font-weight: 900; display: block; margin: 8px 0; }
        
        /* ì•Œë¦¼ ë©”ì‹œì§€ ë””ìì¸ ê°•í™” */
        .zero-msg { color: #1565c0; font-weight: bold; font-size: 0.85em; margin-top: 10px; padding: 12px; background: #e3f2fd; border-radius: 8px; border: 1px solid #90caf9; line-height: 1.5; }
        
        .total-summary { background: #ffebee; padding: 15px; border-radius: 10px; margin-top: 15px; font-weight: bold; text-align: right; border: 2px solid #ef9a9a; color: #c62828; }
        .footer-red { background: #fff5f5; border-radius: 10px; padding: 15px; margin-top: 10px; border: 1px solid #ffa8a8; color: #e03131; font-size: 0.8em; line-height: 1.6; text-align: center; }
        .warning-msg { color: #d32f2f; font-size: 0.75em; font-weight: bold; margin-top: 5px; display: none; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ“ ì§€ì œì—­ í’ê²½ì±„ì–´ë°”ë‹ˆí‹° 2BL</h1>
        <h2>ì”ê¸ˆì„ ë‚©í• ì¸ 7% ëª¨ì˜ê³„ì‚°ê¸°</h2>
        <div class="sub-title">ì”ê¸ˆìë™ê³„ì‚°ê¸°</div>
    </header>

    <div class="card bg-navy">
        <label style="color:#a5d6a7;">ë‚˜ì˜ ì´ˆê¸° ì´ ì”ê¸ˆ</label>
        <input type="text" id="base-total" oninput="updateBase(this)" placeholder="ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”">
        <div id="base-total-kor" class="kor-txt" style="color:#81d4fa;">ì˜ ì›</div>
    </div>

    <div id="row-area"></div>
    <button class="btn-add" onclick="addRow()">+ ì¤‘ê°„ ë‚©ë¶€ ë‚´ì—­ ì¶”ê°€</button>

    <div class="final-area">
        <label>ğŸ—“ï¸ ë§ˆì§€ë§‰ ì”ê¸ˆ ì™„ë‚© ì˜ˆì •ì¼</label>
        <input type="date" id="final-date" oninput="calculate()">
        <div style="margin-top:15px; font-size:0.9em; border-top:1px dashed #fbc02d; padding-top:10px;">
            ì ìš©ì¼ìˆ˜: <b id="f-days">0ì¼</b> | í˜œíƒì´ì: <b id="f-int">0ì›</b>
            <span class="final-val" id="f-pay">ì‹¤ ì…ê¸ˆì•¡: 0ì›</span>
            <div id="f-pay-kor" class="kor-txt">ì˜ ì›</div>
            
            <div id="zero-notice" class="zero-msg" style="display:none;"></div>
        </div>
    </div>

    <div class="total-summary">
        ì´ í˜œíƒ ì´ì í•©ê³„: <span id="total-interest" style="font-size:1.3em;">0</span>ì›
    </div>

    <div class="footer-red">
        <strong>âš ï¸ ì£¼ì˜ì‚¬í•­</strong><br>
        1. 1,000ë§Œ ì› ì´ìƒ ì…ê¸ˆ ì‹œ ì„ ë‚©í• ì¸ì´ ì ìš©ë©ë‹ˆë‹¤.<br>
        2. ì”ì•¡ì„ ì´ˆê³¼í•˜ì—¬ ì…ê¸ˆí•  ìˆ˜ ì—†ë„ë¡ ìë™ ì¡°ì •ë©ë‹ˆë‹¤.<br>
        3. ì‹¤ì œ ì…ê¸ˆì•¡ì€ ì‹œí–‰ì‚¬ ê³ ì§€ì„œì™€ ë°˜ë“œì‹œ ëŒ€ì¡°í•˜ì„¸ìš”.
    </div>
</div>

<script>
    const RATE = 0.07;
    const START_D = new Date('2026-01-23');
    const END_D = new Date('2026-05-04');

    function updateBase(el) {
        let val = el.value.replace(/[^0-9]/g, '');
        el.value = val ? Number(val).toLocaleString() : '';
        document.getElementById('base-total-kor').innerText = val ? numberToKorean(val) + " ì›" : "ì˜ ì›";
        calculate();
    }

    function numberToKorean(number) {
        const units = ['', 'ë§Œ', 'ì–µ', 'ì¡°'];
        let result = '';
        let num = parseInt(number);
        if (num === 0 || isNaN(num)) return 'ì˜';
        for (let i = 0; num > 0; i++) {
            let chunk = num % 10000;
            if (chunk > 0) result = chunk.toLocaleString() + units[i] + ' ' + result;
            num = Math.floor(num / 10000);
        }
        return result.trim();
    }

    function addRow() {
        const id = 'row-' + Date.now();
        const div = document.createElement('div');
        div.className = 'card';
        div.id = id;
        div.innerHTML = `
            <div style="display:flex; gap:10px; margin-bottom:5px;">
                <input type="date" class="i-date" oninput="calculate()" style="flex:1; font-size:0.9em;">
                <input type="text" class="i-amt" placeholder="ì…ê¸ˆì•¡" oninput="handleRowInput(this, '${id}')" style="flex:1.2; font-size:0.9em;">
            </div>
            <div id="${id}-kor" class="kor-txt" style="font-size:0.75em;">ì˜ ì›</div>
            <div class="warning-msg" id="${id}-warn">âš ï¸ ì”ì•¡ ì´ˆê³¼ë¡œ ì¡°ì •ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
            <div class="row-detail">
                <span>ì¼ìˆ˜: <b class="r-days">0ì¼</b></span>
                <span>ì´ì: <b class="r-int">0ì›</b></span>
                <span>ë‚¨ì€ì”ê¸ˆ: <b class="r-bal">0ì›</b></span>
            </div>
            <div onclick="document.getElementById('${id}').remove();calculate();" style="text-align:right; color:#ccc; cursor:pointer; font-size:0.75em; margin-top:5px;">ì‚­ì œ</div>
        `;
        document.getElementById('row-area').appendChild(div);
    }

    function handleRowInput(el, rowId) {
        let val = el.value.replace(/[^0-9]/g, '');
        el.value = val ? Number(val).toLocaleString() : '';
        document.getElementById(rowId + '-kor').innerText = val ? numberToKorean(val) + " ì›" : "ì˜ ì›";
        calculate();
    }

    function calculate() {
        let baseTotal = parseInt(document.getElementById('base-total').value.replace(/,/g, '')) || 0;
        let currentBal = baseTotal;
        let totalIntSum = 0;
        const rows = document.querySelectorAll('#row-area .card');

        rows.forEach(row => {
            const dateInput = row.querySelector('.i-date');
            const amtInput = row.querySelector('.i-amt');
            const warn = row.querySelector('.warning-msg');
            let aVal = parseInt(amtInput.value.replace(/,/g, '')) || 0;

            if (aVal > currentBal && currentBal > 0) {
                warn.style.display = 'block';
                aVal = currentBal;
                amtInput.value = aVal.toLocaleString();
            } else {
                warn.style.display = 'none';
            }

            let interest = 0;
            if (dateInput.value && aVal > 0) {
                const payDate = new Date(dateInput.value);
                let start = payDate < START_D ? START_D : payDate;
                let days = Math.min(100, Math.max(0, Math.ceil((END_D - start) / (1000*60*60*24)) + 1));
                
                if (aVal >= 10000000) {
                    interest = Math.floor((aVal * RATE * days / 365) / 10) * 10;
                }
            }
            if (interest > (currentBal - aVal)) interest = Math.max(0, currentBal - aVal);

            currentBal = currentBal - aVal - interest;
            totalIntSum += interest;
            
            row.querySelector('.r-days').innerText = (dateInput.value ? Math.min(100, Math.max(0, Math.ceil((END_D - (new Date(dateInput.value) < START_D ? START_D : new Date(dateInput.value))) / (1000*60*60*24)) + 1)) : 0) + "ì¼";
            row.querySelector('.r-int').innerText = interest.toLocaleString() + "ì›";
            row.querySelector('.r-bal').innerText = Math.max(0, currentBal).toLocaleString() + "ì›";
        });

        const fDateVal = document.getElementById('final-date').value;
        const zeroNotice = document.getElementById('zero-notice');
        
        if (fDateVal && currentBal > 0) {
            const fDate = new Date(fDateVal);
            let start = fDate < START_D ? START_D : fDate;
            let days = Math.min(100, Math.max(0, Math.ceil((END_D - start) / (1000*60*60*24)) + 1));
            
            let finalInt = Math.floor((currentBal * RATE * days / 365) / 10) * 10;
            let originalBal = currentBal; // ì´ì ë¹¼ê¸° ì „ ì”ê¸ˆ

            if (finalInt >= currentBal) {
                finalInt = currentBal;
                // ğŸ’¡ ì•ˆë‚´ ë¬¸êµ¬ ê°•í™”: ì›ë˜ ì”ê¸ˆì´ ì–¼ë§ˆì˜€ëŠ”ì§€ ë³´ì—¬ì¤Œ
                zeroNotice.innerHTML = `âœ¨ <b>ì•ˆë‚´:</b> ë‚¨ì€ ì”ê¸ˆ ${originalBal.toLocaleString()}ì›ì´ ì„ ë‚© í• ì¸ í˜œíƒ(${finalInt.toLocaleString()}ì›)ìœ¼ë¡œ ëª¨ë‘ ìƒê³„ë˜ì—ˆìŠµë‹ˆë‹¤. <br>ë”°ë¼ì„œ <b>ì‹¤ì œ ë‚©ë¶€í•  ê¸ˆì•¡ì€ 0ì›</b>ì…ë‹ˆë‹¤.`;
                zeroNotice.style.display = 'block';
            } else {
                zeroNotice.style.display = 'none';
            }

            let finalPay = Math.max(0, currentBal - finalInt);

            document.getElementById('f-days').innerText = days + "ì¼";
            document.getElementById('f-int').innerText = finalInt.toLocaleString() + "ì›";
            document.getElementById('f-pay').innerText = "ì‹¤ ì…ê¸ˆì•¡: " + finalPay.toLocaleString() + "ì›";
            document.getElementById('f-pay-kor').innerText = numberToKorean(finalPay) + " ì›";
            totalIntSum += finalInt;
        } else {
            document.getElementById('f-days').innerText = "0ì¼";
            document.getElementById('f-int').innerText = "0ì›";
            document.getElementById('f-pay').innerText = "ì‹¤ ì…ê¸ˆì•¡: 0ì›";
            document.getElementById('f-pay-kor').innerText = "ì˜ ì›";
            zeroNotice.style.display = 'none';
        }
        document.getElementById('total-interest').innerText = Math.floor(totalIntSum).toLocaleString();
    }
    window.onload = () => addRow();
</script>
</body>
</html>
